pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
-- lakeside
-- by sestrenexsis
-- github.com/sestrenexsis/lakeside

_me="sestrenexsis"
_cart="lakeside"
--cartdata(_me.."_".._cart.."_1")
--_version=1

person={}

_layers={
	{ 0,0,16,16,0,0,32.0},
	{16,0, 2,16,0,0,16.0},
	{18,0, 2,16,0,0,4.0},
	{20,0, 2,16,0,0,1.0},
	{22,0, 4,16,0,0,0.8}
}

function person:new(
	x, -- x position : number
	y  -- y position : number
	)
	local obj={
		x=x,
		y=y,
		an=0,
		fc=6
	}
	return setmetatable(
		obj,{__index=self}
	)
end

function person:update()
	if t()%0.25==0 then
		self.an=(self.an+1)%4
	end
end

function person:draw()
	local fx=self.f==4
	spr(
		self.an,60,self.y-16,1,2,fx
		)
end

function _init()
	--_cam={x=0,y=0}
	_p=person:new(64,96)
end

function _update()
	if btn(⬅️) then
		_p.x-=1.5
		if _p.x<0 then
			_p.x+=128*32
		end
		_p.f=4
	elseif btn(➡️) then
		_p.x+=1.5
		if _p.x>=128*32 then
			_p.x-=128*32
		end
		_p.f=6
	end
	_p:update()
end

function drawlayer(l)
	local sw=8*l[3]
	local sh=8*l[4]
	local sx=l[5]
	local sy=l[6]
	sx=(sx-_p.x)/l[7]
	--sy=(sy+_p.y)/l[7]
	repeat
		map(
			l[1],l[2],sx,sy,l[3],l[4]
			)
		sx+=sw
	until sx>=128
end

function _draw()
	cls(2)
	camera()
	for l in all(_layers) do
		if l[7]>=1 then
			drawlayer(l)
		end
	end
	_p:draw()
	for l in all(_layers) do
		if l[7]<1 then
			drawlayer(l)
		end
	end
	print(_p.x,0,0,1)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00222000002220000022200000222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00222000002220000022200000222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00022000000220000002200000022000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00220001002200000022000000220000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02222011002220000122200200222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222100012220001122202201222000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
20222000012222001022220001222200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02222000011222000122200001122200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00022000000220000002200000022000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00022000000220000000200000022000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00220000001200000010220000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02200010001200000100022000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02000001001200000100002000120000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02200001001222000110002200122200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333b333399949999bbb3bbbbcc77cccc0000000000001100000000000000000000000000000000000000000000000000000000000000000000000000
000000003bb3bb3399999999bbbbbbbbcccccccc0000000000001110000000000000000000000000000000000000000000000000000000000000000000000000
000000003333333b99999994bbbbbbb3cccccccc0000000000013311000000000000000000000000000000000000000000000000000000000000000000000000
00000000bb333bb399999999bbbbbbbbcccccccc0000000000113311000000000000000000000000000000000000000000000000000000000000000000000000
00000000333b333399949999bbb3bbbbcccc77770000000001131311100000000000000000000000000000000000000000000000000000000000000000000000
000000003bb3bb3399999999bbbbbbbbcccccccc0c000c0001331111100011000000000000000000000000000000000000000000000000000000000000000000
000000003333333b99999994bbbbbbb3ccccccccccc0ccc001b33111110133100000000000000000000000000000000000000000000000000000000000000000
00000000bb333bb399999999bbbbbbbbccccccccc7ccc7cc01b13331111131100000000000000000000000000000000000000000000000000000000000000000
ddddddddddddddddddddd777777ddddddddddddddddddddd113111113113b3100000000000000000000000000000000000000000000000000000000000000000
ddddddddddddddddddd7777777777ddddddddddddddddddd33331311311313310000000000000000000000000000000000000000000000000000000000000000
dddddddddddddddddd777777777777ddddddddddddddddddbb33131133b331110000000000000000000000000000000000000000000000000000000000000000
ddddddddddddddddd77777777777777dddddddddddddddddb31313311b3133110000000000000000000000000000000000000000000000000000000000000000
ddddddddddddddddd77777777777777ddddddddddddddddd333133113b3111110000000000000000000000000000000000000000000000000000000000000000
ddddddddddddddd77777777777777777777777777ddddddd13133111333311311000000000000000000000000000000000000000000000000000000000000000
dddddddddddddd7777777777777777777777777777dddddd13111113131131111111000000000000000000000000001100000000000000000000000000000000
ddddddddddddd777777777777777777777777777777ddddd1b331131113111111111100000000000000000000000000100000000000000000000000000000000
eeeeeeeedddddd777777777777dddddddddddddddddddddd13111111111113111111010000000000000000000000001100000000000000000000000000000000
ddddddddddddddd7777777777ddddddddddddddddddddddd13311111311131111111100000000000000000000000011100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd13111311111131111110000000000000000000000001011100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd11111111311111111111011000000000000000000001101100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd11113111111133111111111100000000000000000101111100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd31113111311331111111110100000000000000001110111100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd13133333333333311111111100000000000000101111111100000000000000000000000000000000
eeeeeeeedddddddddddddddddddddddddddddddddddddddd11111111111111111111111101000000000011111111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000011111111111111111111111110000000001000111111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000011111111111111111111111111101001001111111111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000011111111111111111111111111110000111111110111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000013313111131111311111111111111111111111111111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000033333333333333331111111111111111111111111111111100000000000000000000000000000000
eeeeeeee000000000000000000000000000000000000000033333333333333331111111111111111111111111111111100000000000000000000000000000000
eeeeeeee300000030000000000000000000000000000000033333333333333331111111111111111111111111111111100000000000000000000000000000000
eeeeeeee330000330000000000000000000000000000000011111111111111111111111111111111111111111111111100000000000000000000000000000000
__map__
5152535454555050505050505050505040404040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6162626262635050515454525355505040404040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5050505050505050616262626263505040404040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6060606060606060606060606060606040404040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6060606060606060606060606060606046474040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7070707070707070707070707070707056574040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404066674040404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404076774545404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404040404444404040404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404040404444717140404040404040404040404040404040404040404040404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404040404040414140404040404040404040404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
4040404040404040404040404040404040404040424240404040404040404040404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
404040404040404040404040404040404040404042424b484940404048494a4b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
404040404040404040404040404040404040404043435b58595a404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
404040404040404040404040404040404040404043436b68696a404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
404040404040404040404040404040404040404043437b78797a404040404040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
